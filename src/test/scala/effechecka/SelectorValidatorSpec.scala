package effechecka

import org.scalatest._

class SelectorValidatorSpec extends WordSpec with Matchers with SelectorValidator {

  "antarctica report" in {
    val wktString = "POLYGON ((-178.59375 -85.1709701284095, -178.59375 -73.84928645675247, -150.46875 -72.63337363853837, -125.15625000000001 -70.4073476760681, -102.65625 -69.4421276134176, -81.5625 -69.4421276134176, -67.5 -57.75107598132101, -45 -61.98026726504402, -50.625 -70.4073476760681, -46.40625 -74.61344527005673, -18.28125 -67.37369797436554, 23.90625 -66.26685631430843, 52.03125 -61.98026726504402, 75.9375 -64.51064316846676, 123.74999999999999 -62.633769607868125, 161.71874999999997 -65.10914820386473, 174.375 -71.7739410364347, 177.18749999999997 -84.8024737243345, -178.59375 -85.1709701284095))"
    validationReport(SelectorParams(wktString = wktString)) should include("side location conflict")
  }

  "some water report" in {
    val wktString = "POLYGON ((40.43 47.373, 39.776 47.205, 39.431 47.117, 38.591 46.86, 38.166 46.696, 38.11 46.392, 38.254 46.171, 38.071 45.971, 37.615 45.664, 37.2 45.335, 36.723 45.362, 36.899 45.26, 36.413 45.229, 36.637 45.378, 35.961 45.373, 35.325 45.392, 34.815 46.125, 34.864 45.94, 34.902 45.861, 35.145 45.55, 35.304 45.298, 34.913 45.681, 34.771 45.901, 34.553 45.84, 34.64 46.089, 34.824 46.19, 35.339 46.34, 34.993 46.094, 36.154 46.67, 36.16 46.535, 36.793 46.671, 37.399 46.955, 37.977 47.097, 38.514 47.193, 38.94 47.254, 39.581 47.207, 39.341 47.176, 39.895 47.263, 40.43 47.373))"
    validationReport(SelectorParams(wktString = wktString)) should be("unsupported wktString [POLYGON ((40.43 47.373, 39.776 47.205, 39.431 47.117, 38.591 46.86, 38.166 46.696, 38.11 46.392, 38.254 46.171, 38.071 45.971, 37.615 45.664, 37.2 45.335, 36.723 45.362, 36.899 45.26, 36.413 45.229, 36.637 45.378, 35.961 45.373, 35.325 45.392, 34.815 46.125, 34.864 45.94, 34.902 45.861, 35.145 45.55, 35.304 45.298, 34.913 45.681, 34.771 45.901, 34.553 45.84, 34.64 46.089, 34.824 46.19, 35.339 46.34, 34.993 46.094, 36.154 46.67, 36.16 46.535, 36.793 46.671, 37.399 46.955, 37.977 47.097, 38.514 47.193, 38.94 47.254, 39.581 47.207, 39.341 47.176, 39.895 47.263, 40.43 47.373))]: Self-intersection at or near point (39.55196087036245, 47.20912923415439, NaN)")
  }

  "some invalid taxon report" in {
    validationReport(SelectorParams(taxonSelector = "Bla%$")) should be("unsupported wktString []: Unknown Shape definition []\nunsupported taxon selector [Bla%$]: taxon names may only contain A-Za-z and whitespaces")
  }

}